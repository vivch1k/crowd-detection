# Детекция людей на видео

Обнаружение людей на видео с использованием модели YOLOv11.

## Описание

Программа обрабатывает видеофайл и выполняет детекцию людей (класс person) на каждом кадре с помощью предобученной модели YOLOv11. Результаты детекции отрисовываются поверх видео в виде ограничивающих рамок (bounding boxes) с указанием названия класса и уверенности (confidence) модели для каждого обнаруженного объекта.

## Выбор модели

Чтобы выбрать оптимальный размер модели, было проведено тестирование на размеченом датасете размером в 81 изображение.

Результаты тестирование
| Model     | mAP50  | Precision  | Recall  | Inference (ms)  |
|-----------|--------|------------|---------|-----------------|
| YOLOv11m  | 0.678  | 0.945      | 0.4     | 17.9            |
| YOLOv11l  | 0.69   | 0.967      | 0.408   | 19.8            |
| YOLOv11x  | 0.685  | 0.961      | 0.407   | 24.0            |

Тестирование показало что модель YOLOv11 размера large, показала лучшее результаты по точности и скорости.

## Установка
1. Клонируйте репозиторий:
```bash
git clone https://github.com/vivch1k/crowd-detection.git
cd crowd-detection
```
2. Создайте и активуруйте виртуальное окружение:
```bash
python3 -m venv .venv
.venv\Scripts\activate # Windows
source .venv/bin/activate # Linux/macOS
```
3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск
#### Обработка видео
Отрисовывает обнаруженных людей и сохраняет аннотированное видео.
```bash
python3 -m src.main
```
Результат сохраняется в ```data/predict_crowd.mp4```
При первом запуске будут скачены веса модели ```yolo11l.pt``` в корень проекта.